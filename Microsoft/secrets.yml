extends: existence
message: "Possible credential or token detected. Mask it if not already done."
level: warning
ignorecase: true
scope: raw

tokens:

  # Bearer tokens (with or without Authorization header)
  - '\bAuthorization:\s*Bearer\s+(?!\d{4}-\d{2}-\d{2}T)[A-Za-z0-9._-]{16,}\b'
  - '\bBearer\s+(?!\d{4}-\d{2}-\d{2}T)[A-Za-z0-9._-]{16,}\b'

  # API key headers
  - '(?i)(x-api-key|api-key|apikey|api_key)\s*[:=]\s+(?!\d{4}-\d{2}-\d{2})[A-Za-z0-9._-]{20,}'

  # Query-string tokens (token=xxx)
  - '(?i)(token|access_token|id_token|auth_token)\s*[:=]\s+(?!\d{4}-\d{2}-\d{2})[A-Za-z0-9._-]{20,}'

  # Base64-like single segment — require ≥ 24 chars and at least one digit
  # (Suppress pure hex, allow mixed secrets)
  - '\b(?=[A-Za-z0-9_-]*[0-9])(?![0-9a-f]{1,32}\b)(?!\d{4}-\d{2}-\d{2})[A-Za-z0-9_-]{24,}\b'

  # Multi-segment JWTs — 3 parts, avoid dotted identifiers and dates
  - '(?i)(?=.*[0-9])\b(?![A-Z][A-Za-z]+\.[a-z][A-Za-z]+)(?!\d{4}-\d{2}-\d{2})[A-Za-z0-9_-]{8,}\.[A-Za-z0-9_-]{8,}\.[A-Za-z0-9_-]{8,}\b'

  # Very long hex strings (≥ 64 chars) — likely real secrets
  - '\b[0-9a-fA-F]{64,}\b'
